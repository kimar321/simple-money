{"version":3,"file":"js/926.26a263ff.js","mappings":"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","sources":["webpack://project-money/./src/views/EditLesson.vue?cbb3","webpack://project-money/./src/views/EditLesson.vue"],"sourcesContent":["import { defineComponent as _defineComponent } from 'vue'\nimport { openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementBlock as _createElementBlock, createElementVNode as _createElementVNode, unref as _unref, createVNode as _createVNode, createTextVNode as _createTextVNode } from \"vue\"\n\nconst _hoisted_1 = { class: \"lesson\" }\nconst _hoisted_2 = { key: 1 }\nconst _hoisted_3 = { key: 0 }\nconst _hoisted_4 = {\n  key: 1,\n  class: \"create-lesson\"\n}\nconst _hoisted_5 = { class: \"header\" }\nconst _hoisted_6 = {\n  key: 0,\n  style: {\"color\":\"#00c48c\"}\n}\n\nimport {computed, onMounted, PropType, ref, watch} from \"vue\";\r\nimport {CardItem} from \"@/types/CardItem\";\r\nimport Card from \"@/components/Card.vue\";\r\nimport {useRoute} from \"vue-router\";\r\nimport {useStore} from \"vuex\";\r\nimport MyButton from \"@/components/UI/MyButton.vue\";\r\nimport CardEdit from \"@/components/CardEdit.vue\";\r\nimport CardEdit2 from \"@/components/CardEdit2.vue\";\r\nimport Editor from \"@/components/UI/Editor.vue\";\r\nimport {SubItemLesson} from \"@/types/SubItemLesson\";\r\nimport {LessonPage} from \"@/types/LessonPage\";\r\n\r\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'EditLesson',\n  props: {\r\n  lessonItem: {\r\n    type: Object as PropType<CardItem>,\r\n    default: () => ({id: Date.now(), title: '', description: '', type: 'module'} as CardItem)\r\n  },\r\n  route: {\r\n    type: String\r\n  },\r\n  edit: {\r\n    type: Boolean,\r\n    default: false\r\n\r\n  }\r\n},\n  setup(__props) {\n\nconst props = __props;\n\r\nconst store = useStore()\r\nconst route = useRoute()\r\nconst router = useRoute()\r\n\r\nconst showLesson = computed({\r\n  get: () => store.state.lesson.showLesson,\r\n  set: (val) => store.state.lesson.showLesson = val\r\n})\r\nconst lessonCard = computed<SubItemLesson>({\r\n  get: () => store.state.lesson.tmpLesson,\r\n  set: (val) => store.state.lesson.tmpLesson = val\r\n})\r\nconst lessonPage = computed<LessonPage>({\r\n  get: () => store.state.lesson.lessonPage,\r\n  set: (val) => store.state.lesson.lessonPage = val\r\n})\r\nconst cardRef = ref<InstanceType<typeof CardEdit2> | null>(null)\r\n\r\nwatch(\r\n    () => route.params.id,\r\n    (newValue, oldValue) => {\r\n      if (newValue === oldValue) return\r\n      console.log(route.params.id)\r\n      store.dispatch('lesson/selectLesson', {id: route.params.id})\r\n      // lessonPage.value=store.getters['lessons/getLessonPage'](router.params.id).content\r\n    },\r\n    {immediate: true, deep: true}\r\n)\r\nconst saveLessonCard = () => {\r\n  store.dispatch('lesson/updateLesson', {item: lessonCard.value})\r\n  cardRef.value.onEdit()\r\n}\r\nconst editLessonCard = () => {\r\n  cardRef.value.onEdit()\r\n}\r\nconst saveLessonPage = () => {\r\n  if (lessonPage.value.id === -1) {\r\n    lessonPage.value.lesson_id = lessonCard.value.id\r\n    store.dispatch('lesson/createLessonPage', {item: lessonPage.value})\r\n  } else\r\n    store.dispatch('lesson/updateLessonPage', {item: lessonPage.value})\r\n}\r\n\r\nconst handleFileChange = (event: Event) => {\r\n  const inputElement = event.target as HTMLInputElement;\r\n  const file = inputElement.files?.[0];\r\n  if (file) {\r\n    const reader = new FileReader();\r\n    reader.onload = (e: ProgressEvent<FileReader>) => {\r\n      lessonPage.value.page = e.target?.result as string\r\n    };\r\n    reader.readAsText(file);\r\n  }\r\n}\r\nconst createFile = () => {\r\n  const fileName = `Module ${lessonCard.value.module_id} Lesson ${lessonCard.value.title}.txt`; // Имя файла\r\n\r\n  const file = new Blob([lessonPage.value.page], {type: 'text/plain'});\r\n\r\n  // Создаем ссылку для скачивания файла\r\n  const downloadLink = document.createElement('a');\r\n  downloadLink.href = URL.createObjectURL(file);\r\n  downloadLink.download = fileName;\r\n\r\n  // Симулируем клик на ссылку для скачивания файла\r\n  document.body.appendChild(downloadLink);\r\n  downloadLink.click();\r\n  document.body.removeChild(downloadLink);\r\n}\r\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"main\", null, [\n    _createElementVNode(\"div\", _hoisted_1, [\n      (showLesson.value)\n        ? (_openBlock(), _createBlock(CardEdit2, {\n            modelValue: lessonCard.value,\n            \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((lessonCard).value = $event)),\n            type: \"module\",\n            edit: true,\n            onSave: saveLessonCard,\n            onEdit: editLessonCard,\n            ref_key: \"cardRef\",\n            ref: cardRef,\n            key: lessonCard.value.id\n          }, null, 8, [\"modelValue\"]))\n        : (_openBlock(), _createElementBlock(\"h3\", _hoisted_2, \"Загрузка...\"))\n    ]),\n    (_unref(store).state.lesson.loadLessonPage)\n      ? (_openBlock(), _createElementBlock(\"h3\", _hoisted_3, \"Загрузка...\"))\n      : (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [\n          _createElementVNode(\"header\", _hoisted_5, [\n            _createVNode(MyButton, {\n              color: \"success\",\n              label: \"Сохранить\",\n              onClick: saveLessonPage,\n              disabled: _unref(store).state.lesson.saveLessonPage\n            }, null, 8, [\"disabled\"]),\n            _createElementVNode(\"label\", {\n              for: \"fileInput\",\n              class: \"custom-file-upload\"\n            }, [\n              _createTextVNode(\" Загрузить файл \"),\n              _createElementVNode(\"input\", {\n                type: \"file\",\n                id: \"fileInput\",\n                onClick: handleFileChange\n              })\n            ]),\n            _createVNode(MyButton, {\n              color: \"success\",\n              label: \"Скачать\",\n              onClick: createFile\n            })\n          ]),\n          (_unref(store).state.lesson.saveLessonPage)\n            ? (_openBlock(), _createElementBlock(\"h3\", _hoisted_6, \"Сохранение.....\"))\n            : _createCommentVNode(\"\", true),\n          (_openBlock(), _createBlock(Editor, {\n            modelValue: lessonPage.value.page,\n            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((lessonPage.value.page) = $event)),\n            key: lessonPage.value.id\n          }, null, 8, [\"modelValue\"]))\n        ]))\n  ]))\n}\n}\n\n})","import script from \"./EditLesson.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./EditLesson.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./EditLesson.vue?vue&type=style&index=0&id=3ed63c32&lang=scss\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["_hoisted_1","class","_hoisted_2","key","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","style","_defineComponent","__name","props","lessonItem","type","Object","default","id","Date","now","title","description","route","String","edit","Boolean","setup","__props","store","useStore","useRoute","showLesson","computed","get","state","lesson","set","val","lessonCard","tmpLesson","lessonPage","cardRef","ref","watch","params","newValue","oldValue","console","log","dispatch","immediate","deep","saveLessonCard","item","value","onEdit","editLessonCard","saveLessonPage","lesson_id","handleFileChange","event","inputElement","target","file","files","reader","FileReader","onload","e","page","result","readAsText","createFile","fileName","module_id","Blob","downloadLink","document","createElement","href","URL","createObjectURL","download","body","appendChild","click","removeChild","_ctx","_cache","_openBlock","_createElementBlock","_createElementVNode","_createBlock","CardEdit2","modelValue","$event","onSave","ref_key","_unref","loadLessonPage","_createVNode","MyButton","color","label","onClick","disabled","for","_createTextVNode","_createCommentVNode","Editor","__exports__"],"sourceRoot":""}